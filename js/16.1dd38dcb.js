"use strict";(self["webpackChunksales_tnp_vue"]=self["webpackChunksales_tnp_vue"]||[]).push([[16],{90016:function(e,t,a){a.r(t),a.d(t,{default:function(){return w}});var s=a(56768),i=a(24232);const l={class:"login-container"},o={class:"login-container__body"},n={class:"title-container"},d={class:"input-data"},r={class:"show-hide-password"},c={class:"text-center"},u={class:"text-center"};function h(e,t,a,h,g,m){const k=(0,s.g2)("v-progress-circular"),p=(0,s.g2)("v-text-field"),v=(0,s.g2)("v-icon"),w=(0,s.g2)("v-btn"),b=(0,s.g2)("v-snackbar"),f=(0,s.g2)("v-spacer"),_=(0,s.g2)("v-card"),L=(0,s.g2)("v-dialog");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",l,[t[10]||(t[10]=(0,s.Lk)("div",{class:"login-container__asside"},null,-1)),(0,s.Lk)("div",o,[(0,s.Lk)("div",n,[t[6]||(t[6]=(0,s.Lk)("h2",null,"Авторизация",-1)),g.isShowAuthLoader?((0,s.uX)(),(0,s.Wv)(k,{key:0,color:"green",indeterminate:""})):(0,s.Q3)("",!0)]),(0,s.Lk)("div",d,[(0,s.bF)(p,{class:"input-data__login",modelValue:g.login,"onUpdate:modelValue":t[0]||(t[0]=e=>g.login=e),rules:g.loginRules,"hide-details":"auto",label:"Ваш логин"},null,8,["modelValue","rules"]),(0,s.Lk)("div",r,[(0,s.bF)(p,{class:"input-data__password",modelValue:g.password,"onUpdate:modelValue":t[1]||(t[1]=e=>g.password=e),rules:g.passwordRules,"hide-details":"auto",label:"Ваш пароль",type:g.showPassword?"text":"password"},null,8,["modelValue","rules","type"]),g.showPassword?((0,s.uX)(),(0,s.Wv)(v,{key:0,class:"input-data__password-icon",onClick:m.togglePasswordVisibility},{default:(0,s.k6)((()=>t[7]||(t[7]=[(0,s.eW)("mdi-eye ")]))),_:1},8,["onClick"])):(0,s.Q3)("",!0),g.showPassword?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(v,{key:1,class:"input-data__password-icon",onClick:m.togglePasswordVisibility},{default:(0,s.k6)((()=>t[8]||(t[8]=[(0,s.eW)("mdi-eye-off ")]))),_:1},8,["onClick"]))])]),(0,s.bF)(w,{disabled:!g.availableConfirmBtn,block:"",class:"confirm-btn",onClick:m.checkAuth},{default:(0,s.k6)((()=>t[9]||(t[9]=[(0,s.eW)(" Войти ")]))),_:1},8,["disabled","onClick"])])]),(0,s.Lk)("div",c,[(0,s.bF)(b,{modelValue:g.snackbar,"onUpdate:modelValue":t[3]||(t[3]=e=>g.snackbar=e),"multi-line":"",timeout:"3000",style:{"margin-bottom":"60px"}},{actions:(0,s.k6)((()=>[(0,s.bF)(w,{color:"red",variant:"text",onClick:t[2]||(t[2]=e=>g.snackbar=!1)},{default:(0,s.k6)((()=>t[11]||(t[11]=[(0,s.eW)(" Close ")]))),_:1})])),default:(0,s.k6)((()=>[(0,s.eW)((0,i.v_)(g.snackbarText)+" ",1)])),_:1},8,["modelValue"])]),(0,s.Lk)("div",u,[(0,s.bF)(L,{modelValue:g.dialog,"onUpdate:modelValue":t[5]||(t[5]=e=>g.dialog=e),"max-width":"400",persistent:""},{default:(0,s.k6)((()=>[(0,s.bF)(_,{"prepend-icon":"mdi-information",text:g.dialogText,title:g.dialogTitle},{actions:(0,s.k6)((()=>[(0,s.bF)(f),(0,s.bF)(w,{onClick:t[4]||(t[4]=e=>g.dialog=!1),color:"red"},{default:(0,s.k6)((()=>t[12]||(t[12]=[(0,s.eW)(" Закрыть ")]))),_:1})])),_:1},8,["text","title"])])),_:1},8,["modelValue"])])],64)}a(44114),a(98992),a(54520);var g=a(46587),m=a.n(g),k={name:"LoginComponent",components:{},data(){return{dialog:!1,login:"",password:"",checkRegEx:{log:!1,pass:!1},availableConfirmBtn:!1,loginRules:[e=>!!e||"Требуется логин.",e=>e&&e.length>=3||"Логин должен содержать минимум 3 символа",e=>this.validateLogin(e)||'Логин должен быть в формате "*.*******"'],passwordRules:[e=>!!e||"Требуется пароль.",e=>e&&e.length>=3||"Пароль должен содержать минимум 3 символа",e=>this.validateEmail(e)||"Подсказка: пароль должен содержать @"],dialogText:"",dialogTitle:"",isShowAuthLoader:!1,snackbar:!1,snackbarText:"",showPassword:!1}},methods:{togglePasswordVisibility(){this.showPassword=!this.showPassword},handleEnter(e){"Enter"===e.key&&this.availableConfirmBtn&&this.checkAuth()},validateLogin(e){const t=/^[a-zA-Z]\.[a-zA-Z]+$/;return this.checkRegEx.log=t.test(e),t.test(e)},validateEmail(e){const t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return this.checkRegEx.pass=t.test(e),t.test(e)},async checkAuth(){this.availableConfirmBtn=!1,this.isShowAuthLoader=!0;let e=null;await m().ajax({url:"https://script.google.com/macros/s/AKfycbzlA3mS-tvOR0onR5y3seF1E8p7CwsUPuhxhKFGVKOf-btPNTqLGOv3V-vtg9c4LKJT5A/exec",type:"GET",crossDomain:!0,dataType:"json",success:t=>{if(e=t.stuff.filter((e=>e.LoginName==this.login)),e.length<1&&(this.availableConfirmBtn=!0,this.isShowAuthLoader=!1,this.dialogTitle="Сотрудник не найден",this.dialogText="Убедитесь, что вводите логин правильно",this.dialog=!0),e.length>0)if(e[0].PasswordEmail==this.password){let t={login:e[0].LoginName,role:e[0].RoleStatus};"super"!=e[0].RoleStatus&&"manager"!=e[0].RoleStatus||(localStorage.setItem("sale-auth",JSON.stringify(t)),this.$emit("updateUserStatus","check"),this.$router.push("/")),"promoter"==e[0].RoleStatus&&(localStorage.setItem("sale-auth",JSON.stringify(t)),this.$emit("updateUserStatus","check"),this.$router.push("/"))}else e[0].PasswordEmail!=this.password&&(this.dialogTitle="Неправильный пароль",this.dialogText="Убедитесь, что вводите пароль правильно",this.dialog=!0,this.availableConfirmBtn=!0,this.isShowAuthLoader=!1)},error:e=>{console.log(e),this.snackbarText="Ошибка загрузки данных с вервера, повторите попытку позже",this.snackbar=!0,this.availableConfirmBtn=!0,this.isShowAuthLoader=!1}})}},watch:{checkRegEx:{handler(e){e.log&&e.pass?this.availableConfirmBtn=!0:this.availableConfirmBtn=!1},deep:!0}},mounted(){document.addEventListener("keydown",this.handleEnter)},beforeUnmount(){document.removeEventListener("keydown",this.handleEnter),this.login="",this.password=""}},p=a(71241);const v=(0,p.A)(k,[["render",h],["__scopeId","data-v-1c41ea38"]]);var w=v}}]);
//# sourceMappingURL=16.1dd38dcb.js.map