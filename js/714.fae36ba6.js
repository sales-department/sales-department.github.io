"use strict";(self["webpackChunksales_tnp_vue"]=self["webpackChunksales_tnp_vue"]||[]).push([[714],{12714:function(t,a,e){e.r(a),e.d(a,{default:function(){return Q}});var o=e(56768);const r={key:1,class:"analitic-container"},s={class:"secondaty-chart"};function n(t,a,e,n,i,l){const h=(0,o.g2)("v-empty-state"),d=(0,o.g2)("MainChartComponent"),c=(0,o.g2)("SecondaryChartNewComponent"),u=(0,o.g2)("SecondaryChartWithAvailableComponent"),C=(0,o.g2)("SecondaryChartFullAvailableComponent");return(0,o.uX)(),(0,o.CE)(o.FK,null,[i.isShowChartData?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(h,{key:0,headline:"Whoops, 404",image:"https://vuetifyjs.b-cdn.net/docs/images/logos/v.png"})),i.isShowChartData?((0,o.uX)(),(0,o.CE)("div",r,[(0,o.bF)(d),(0,o.Lk)("div",s,[(0,o.bF)(c),(0,o.bF)(u),(0,o.bF)(C)])])):(0,o.Q3)("",!0)],64)}const i={class:"main-chart-container"},l={class:"analitic__main-chart"},h={class:"main-chart"},d={ref:"mainChart",class:"main-chart__data"},c={class:"main-chart__buttons"},u={class:"count-data__btn"},C={class:"summ-data__btn"};function v(t,a,e,r,s,n){const v=(0,o.g2)("v-btn");return(0,o.uX)(),(0,o.CE)("div",i,[(0,o.Lk)("div",l,[(0,o.Lk)("div",h,[(0,o.Lk)("canvas",d,null,512)]),(0,o.Lk)("div",c,[(0,o.Lk)("div",u,[(0,o.bF)(v,{class:"count-btn",color:"teal",size:"small",onClick:n.showTrade},{default:(0,o.k6)((()=>a[0]||(a[0]=[(0,o.Lk)("span",null,"Торговые марки",-1)]))),_:1},8,["onClick"]),(0,o.bF)(v,{class:"count-btn",color:"teal",size:"small",onClick:n.showGrope},{default:(0,o.k6)((()=>a[1]||(a[1]=[(0,o.Lk)("span",null,"Категории",-1)]))),_:1},8,["onClick"]),(0,o.bF)(v,{class:"count-btn",color:"deep-purple-lighten-2",size:"small",onClick:n.showOnStore},{default:(0,o.k6)((()=>a[2]||(a[2]=[(0,o.Lk)("span",null,"С остатком",-1)]))),_:1},8,["onClick"]),(0,o.bF)(v,{class:"count-btn",color:"blue-lighten-1",size:"small",onClick:n.showOutOfStore},{default:(0,o.k6)((()=>a[3]||(a[3]=[(0,o.Lk)("span",null,"Без остатка",-1)]))),_:1},8,["onClick"])]),(0,o.Lk)("div",C,[(0,o.bF)(v,{class:"summ-btn",color:"teal",size:"small",onClick:n.showAllGoods},{default:(0,o.k6)((()=>a[4]||(a[4]=[(0,o.Lk)("span",null,"Товар",-1)]))),_:1},8,["onClick"]),(0,o.bF)(v,{class:"summ-btn",color:"green-darken-1",size:"small",onClick:n.showAvailable},{default:(0,o.k6)((()=>a[5]||(a[5]=[(0,o.Lk)("span",null,"Доступно",-1)]))),_:1},8,["onClick"]),(0,o.bF)(v,{class:"summ-btn",color:"orange-darken-1",size:"small",onClick:n.showReserve},{default:(0,o.k6)((()=>a[6]||(a[6]=[(0,o.Lk)("span",null,"Резерв",-1)]))),_:1},8,["onClick"])])])])])}e(98992),e(54520),e(81454),e(8872);var p=e(21510),b=e(97283),g=e(23408);b.t1.register(...b.$L,g.A);var m={name:"MainChartComponent",data(){return{dataForAnalysis:[],tmData:[],tmCountData:[],tmCount:0,gropeData:[],gropeCountData:[],gropeCount:0,onStoreData:[],onStoreCountData:[],onStoreCount:0,outOfStoreData:[],outOfStoreCountData:[],outOfStoreCount:0,availableAllData:[],availableAllCountData:[],availableAllCount:0,availableData:[],availableCountData:[],availableCount:0,reservData:[],reservCountData:[],reservCount:0}},methods:{createDataForChart(){this.dataForAnalysis=[...p.c.getGoodAndReservData()],this.getTradeMarkData(),this.getGropeData(),this.getOnStoreData(),this.getOutOfStoreData(),this.getAllGoodsData(),this.getAvailableData(),this.getReserveData(),this.showTrade()},getTradeMarkData(){const t=this.dataForAnalysis.reduce(((t,a)=>(t[a.Tm]=(t[a.Tm]||0)+1,t)),{}),a=Object.entries(t).map((([t,a])=>({tm:t,count:a}))).sort(((t,a)=>a.count-t.count)),e=a.map((t=>t.tm)),o=a.map((t=>t.count));this.tmData=e,this.tmCountData=o,this.tmCount=e.length},getGropeData(){const t=this.dataForAnalysis.reduce(((t,a)=>(t[a.Grope]=(t[a.Grope]||0)+1,t)),{}),a=Object.entries(t).map((([t,a])=>({grope:t,count:a}))).sort(((t,a)=>a.count-t.count)),e=a.map((t=>t.grope)),o=a.map((t=>t.count)),r=a.reduce(((t,a)=>t+a.count),0);this.gropeData=e,this.gropeCountData=o,this.gropeCount=r},getOnStoreData(){const t=this.dataForAnalysis.filter((t=>0!==t.Available)),a=t.reduce(((t,a)=>(t[a.Grope]||(t[a.Grope]=0),t[a.Grope]+=1,t)),{}),e=Object.entries(a).map((([t,a])=>({grope:t,available:a}))).sort(((t,a)=>a.available-t.available)),o=e.map((t=>t.grope)),r=e.map((t=>t.available)),s=e.reduce(((t,a)=>t+a.available),0);this.onStoreData=o,this.onStoreCountData=r,this.onStoreCount=s},getOutOfStoreData(){const t=this.dataForAnalysis.filter((t=>0===t.Available)),a=t.reduce(((t,a)=>(t[a.Grope]||(t[a.Grope]=0),t[a.Grope]+=1,t)),{}),e=Object.entries(a).map((([t,a])=>({grope:t,notAvailable:a}))).sort(((t,a)=>a.notAvailable-t.notAvailable)),o=e.map((t=>t.grope)),r=e.map((t=>t.notAvailable)),s=e.reduce(((t,a)=>t+a.notAvailable),0);this.outOfStoreData=o,this.outOfStoreCountData=r,this.outOfStoreCount=s},getAllGoodsData(){const t=this.dataForAnalysis.reduce(((t,a)=>(t[a.Grope]||(t[a.Grope]=0),t[a.Grope]+=a.Reserv+a.Available+a.Available2320+a.AvailableDpm,t)),{}),a=Object.entries(t).map((([t,a])=>({grope:t,available:a}))).sort(((t,a)=>a.available-t.available)),e=a.map((t=>t.grope)),o=a.map((t=>t.available)),r=a.reduce(((t,a)=>t+a.available),0);this.availableAllData=e,this.availableAllCountData=o,this.availableAllCount=r},getAvailableData(){const t=this.dataForAnalysis.reduce(((t,a)=>(t[a.Grope]||(t[a.Grope]=0),t[a.Grope]+=a.Available+a.AvailableDpm+a.Available2320,t)),{}),a=Object.entries(t).map((([t,a])=>({grope:t,available:a}))).sort(((t,a)=>a.available-t.available)),e=a.map((t=>t.grope)),o=a.map((t=>t.available)),r=a.reduce(((t,a)=>t+a.available),0);this.availableData=e,this.availableCountData=o,this.availableCount=r},getReserveData(){const t=this.dataForAnalysis.reduce(((t,a)=>(t[a.Grope]||(t[a.Grope]=0),t[a.Grope]+=a.Reserv,t)),{}),a=Object.entries(t).map((([t,a])=>({grope:t,reserv:a}))).sort(((t,a)=>a.reserv-t.reserv)),e=a.map((t=>t.grope)),o=a.map((t=>t.reserv)),r=a.reduce(((t,a)=>t+a.reserv),0);this.reservData=e,this.reservCountData=o,this.reservCount=r},destroyChart(){this.chart&&(this.chart.destroy(),this.chart=null)},showTrade(){this.destroyChart();let t=`Товар в разрезе торговых марок (${this.tmCount.toLocaleString()} позиций)`;this.tradeMarkChart(this.tmData,this.tmCountData,t,"#00897B","#4DB6AC","#00897B")},showGrope(){this.destroyChart();let t=`Товар в разрезе категорий (${this.gropeCount.toLocaleString()} позиций)`;this.tradeMarkChart(this.gropeData,this.gropeCountData,t,"#00897B","#4DB6AC","#00897B")},showOnStore(){this.destroyChart();let t=`Товар с остатком в разрезе категорий (${this.onStoreCount.toLocaleString()} позиций)`;this.tradeMarkChart(this.onStoreData,this.onStoreCountData,t,"#7E57C2","#B39DDB","#7E57C2")},showOutOfStore(){this.destroyChart();let t=`Товар без остатка в разрезе категорий (${this.outOfStoreCount.toLocaleString()} позиций)`;this.tradeMarkChart(this.outOfStoreData,this.outOfStoreCountData,t,"#1E88E5","#64B5F6","#1E88E5")},showAllGoods(){this.destroyChart();let t=`Доступный и зарезервированный товар в разрезе категорий (${this.availableAllCount.toLocaleString()} едениц)`;this.tradeMarkChart(this.availableAllData,this.availableAllCountData,t,"#00897B","#4DB6AC","#00897B")},showAvailable(){this.destroyChart();let t=`Доступные остатки товара в разрезе категорий (${this.availableCount.toLocaleString()} едениц)`;this.tradeMarkChart(this.availableData,this.availableCountData,t,"#388E3C","#66BB6A","#388E3C")},showReserve(){this.destroyChart();let t=`Зарезервированные остатки товара в разрезе категорий (${this.reservCount.toLocaleString()} едениц)`;this.tradeMarkChart(this.reservData,this.reservCountData,t,"#F57C00","#FFA726","#F57C00")},tradeMarkChart(t,a,e,o,r,s){let n="Едениц";const i=this.$refs.mainChart.getContext("2d"),l=i.createLinearGradient(0,0,0,400);l.addColorStop(0,o),l.addColorStop(1,r),this.chart=new b.t1(i,{type:"bar",data:{labels:t,datasets:[{label:n,data:a,backgroundColor:l,borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:!1,subtitle:{display:!0,text:e,font:{weight:"bold",size:"15"},padding:{top:5,bottom:35}},datalabels:{color:s,anchor:"end",align:"top",formatter:t=>0!==t?t.toLocaleString():""}},scales:{y:{beginAtZero:!0},x:{grid:{display:!1}}}}})}},mounted(){this.createDataForChart(),window.addEventListener("resize",(()=>{this.chart&&this.chart.update()}))},beforeUnmount(){document.removeEventListener("resize",this.handleEscape)}},A=e(71241);const f=(0,A.A)(m,[["render",v],["__scopeId","data-v-f8d70ef8"]]);var D=f;const y={class:"secondary-chart-container"},k={class:"analitic__secondary-chart"},w={ref:"secondaryChart",class:"secondary-chart__data"};function S(t,a,e,r,s,n){return(0,o.uX)(),(0,o.CE)("div",y,[(0,o.Lk)("div",k,[(0,o.Lk)("canvas",w,null,512)])])}b.t1.register(...b.$L,g.A);var F={name:"SecondaryChartNewComponent",data(){return{dataForAnalysis:[],goodsNewCount:0,goodsOldCount:0}},methods:{createDataForChart(){this.dataForAnalysis=[...p.c.getGoodAndReservData()],this.getNewOldCount(),this.showCharts()},getNewOldCount(){const t=this.dataForAnalysis.filter((t=>"Новинка"==t.Status)),a=this.dataForAnalysis.filter((t=>"Постоянный ассортимент"==t.Status));this.goodsNewCount=t,this.goodsOldCount=a},showCharts(){this.destroyChart(),this.tradeMarkChart()},destroyChart(){this.chart&&(this.chart.destroy(),this.chart=null)},tradeMarkChart(){const t={labels:["Новый товар","Старый товар"],datasets:[{label:"Едениц",data:[this.goodsNewCount.length,this.goodsOldCount.length],backgroundColor:["rgba(255,0,0,0.9)","rgba(128, 128, 128,0.9)"],borderColor:"white",hoverOffset:3}]},a={responsive:!0,plugins:{legend:{position:"top"},tooltip:{enabled:!0},subtitle:{display:!0,text:"Соотношение нового и старого товара",font:{weight:"bold"}},datalabels:{color:"#ffffff",anchor:"center",align:"center",formatter:t=>0!==t?t.toLocaleString():""}}},e=this.$refs.secondaryChart.getContext("2d");this.chart=new b.t1(e,{type:"doughnut",data:t,options:a})}},mounted(){this.createDataForChart(),window.addEventListener("resize",(()=>{this.chart&&this.chart.update()}))},beforeUnmount(){document.removeEventListener("resize",this.handleEscape)}};const L=(0,A.A)(F,[["render",S],["__scopeId","data-v-78a07ee3"]]);var O=L;const _={class:"secondary-chart-container"},G={class:"analitic__secondary-chart"},E={ref:"secondaryChart",class:"secondary-chart__data"};function R(t,a,e,r,s,n){return(0,o.uX)(),(0,o.CE)("div",_,[(0,o.Lk)("div",G,[(0,o.Lk)("canvas",E,null,512)])])}b.t1.register(...b.$L,g.A);var W={name:"SecondaryChartWithAvailableComponent",data(){return{dataForAnalysis:[],goodsWithAvailable:0,goodsOutOfhAvailable:0}},methods:{createDataForChart(){this.dataForAnalysis=[...p.c.getGoodAndReservData()],this.getWithOutCount(),this.showCharts()},getWithOutCount(){const t=this.dataForAnalysis.filter((t=>t.Available+t.AvailableDpm+t.Available2320+t.Reserv!==0)),a=this.dataForAnalysis.filter((t=>t.Available+t.AvailableDpm+t.Available2320+t.Reserv===0));this.goodsWithAvailable=t,this.goodsOutOfhAvailable=a},showCharts(){this.destroyChart(),this.tradeMarkChart()},destroyChart(){this.chart&&(this.chart.destroy(),this.chart=null)},tradeMarkChart(){const t={labels:["С остатком","Без остатка"],datasets:[{label:"Едениц",data:[this.goodsWithAvailable.length,this.goodsOutOfhAvailable.length],backgroundColor:["rgba(153, 102, 255, 0.8)","rgba(54, 162, 235, 0.8)"],borderColor:"white",hoverOffset:3}]},a={responsive:!0,plugins:{legend:{position:"top"},tooltip:{enabled:!0},subtitle:{display:!0,text:"Соотношение товара с остатком и без остатка",font:{weight:"bold"}},datalabels:{color:"#ffffff",anchor:"center",align:"center",formatter:t=>0!==t?t.toLocaleString():""}}},e=this.$refs.secondaryChart.getContext("2d");this.chart=new b.t1(e,{type:"doughnut",data:t,options:a})}},mounted(){this.createDataForChart(),window.addEventListener("resize",(()=>{this.chart&&this.chart.update()}))},beforeUnmount(){document.removeEventListener("resize",this.handleEscape)}};const M=(0,A.A)(W,[["render",R],["__scopeId","data-v-7da3ebf6"]]);var z=M;const $={class:"secondary-chart-container"},B={class:"analitic__secondary-chart"},x={ref:"secondaryChart",class:"secondary-chart__data"};function N(t,a,e,r,s,n){return(0,o.uX)(),(0,o.CE)("div",$,[(0,o.Lk)("div",B,[(0,o.Lk)("canvas",x,null,512)])])}b.t1.register(...b.$L,g.A);var j={name:"SecondaryChartFullAvailableComponent",data(){return{dataForAnalysis:[],goodsFullAvailable:0,goodsFullReserv:0}},methods:{createDataForChart(){this.dataForAnalysis=[...p.c.getGoodAndReservData()],this.getAvailableResrvCount(),this.showCharts()},getAvailableResrvCount(){const t=this.dataForAnalysis.reduce(((t,a)=>t+a.Available+a.AvailableDpm+a.Available2320),0),a=this.dataForAnalysis.reduce(((t,a)=>t+a.Reserv),0);this.goodsFullAvailable=t,this.goodsFullReserv=a},showCharts(){this.destroyChart(),this.tradeMarkChart()},destroyChart(){this.chart&&(this.chart.destroy(),this.chart=null)},tradeMarkChart(){const t={labels:["Доступно","Резерв"],datasets:[{label:"Едениц",data:[this.goodsFullAvailable,this.goodsFullReserv],backgroundColor:["rgba(28,175,0,0.8)","rgba(255,137,36,0.8)"],borderColor:"white",hoverOffset:3}]},a={responsive:!0,plugins:{legend:{position:"top"},tooltip:{enabled:!0},subtitle:{display:!0,text:"Соотношение доступного и зарезервированного товара",font:{weight:"bold"}},datalabels:{color:"#ffffff",anchor:"center",align:"center",formatter:t=>0!==t?t.toLocaleString():""}}},e=this.$refs.secondaryChart.getContext("2d");this.chart=new b.t1(e,{type:"doughnut",data:t,options:a})}},mounted(){this.createDataForChart(),window.addEventListener("resize",(()=>{this.chart&&this.chart.update()}))},beforeUnmount(){document.removeEventListener("resize",this.handleEscape)}};const I=(0,A.A)(j,[["render",N],["__scopeId","data-v-f882aac8"]]);var T=I,X={name:"AnaliticComponent",components:{SecondaryChartFullAvailableComponent:T,SecondaryChartWithAvailableComponent:z,SecondaryChartNewComponent:O,MainChartComponent:D},data(){return{currentRole:"promoter",screenWidth:window.innerWidth,isShowChartData:""}},methods:{checkRole(){let t=JSON.parse(localStorage.getItem("sale-auth"));this.currentRole=t.role},isShowChart(){"promoter"===this.currentRole||this.screenWidth<990?this.isShowChartData=!1:this.isShowChartData=!0},updateWidth(){this.screenWidth=window.innerWidth}},watch:{screenWidth(t){t<990?this.isShowChartData=!1:t>989&&(this.isShowChartData=!0)}},created(){window.addEventListener("resize",this.updateWidth)},mounted(){this.checkRole(),this.isShowChart(),localStorage.setItem("checkLoadStatus","loaded")},beforeUnmount(){localStorage.removeItem("checkLoadStatus"),window.removeEventListener("resize",this.updateWidth)}};const U=(0,A.A)(X,[["render",n],["__scopeId","data-v-683d020c"]]);var Q=U}}]);
//# sourceMappingURL=714.fae36ba6.js.map